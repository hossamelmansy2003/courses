(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2142,5048,3100],{1704:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[id]",function(){return n(65422)}])},88223:function(e,t,n){"use strict";n.d(t,{o:function(){return a}});var o=n(97458),l=n(52983),r=n(89062),i=n(35240),s=n(6552);const a=l.forwardRef(((e,t)=>{let{children:n,contentWrapperCssClasses:l="flex-grow overflow-hidden",headerControl:a,headerWrapperCssClasses:c="bg-white h-16 flex items-center px-6 border-b border-gray-100 flex-shrink-0",id:d}=e;const u=(0,r.useRecoilValue)(i.qx);return(0,o.jsxs)("div",{id:d,ref:t,"data-onboarding-watch":"create_menu_new_button",className:"absolute inset-0 flex flex-col w-full overflow-y-auto",children:[a&&(0,o.jsx)("div",{className:c,children:a}),u?(0,o.jsx)(s.a,{size:"lg"}):(0,o.jsx)("div",{className:l,children:n})]})}));a.displayName="PageScaffold"},59862:function(e,t,n){"use strict";n.d(t,{O:function(){return r}});var o=n(52983),l=n(9233);const r=e=>{let{scopes:t}=e;const n=(0,o.useCallback)((()=>Boolean(null==t?void 0:t.includes(l.l.DOWNLOAD))),[t]);return{hasUpdateAccess:(0,o.useCallback)((()=>Boolean(null==t?void 0:t.includes(l.l.FULL_ACCESS))),[t]),hasDownloadAccess:n}}},53304:function(e,t,n){"use strict";var o=n(52983);t.Z=e=>{let{onPress:t,onRelease:n,dependencies:l=[],takesPrecedence:r}=e;(0,o.useEffect)((()=>{const e=e=>{const n=document.activeElement;n&&n.isContentEditable||n&&"button"===n.tagName.toLowerCase()&&!r||"Shift"===e.key&&(e.preventDefault(),t())},o=e=>{const t=document.activeElement;t&&t.isContentEditable||t&&"button"===t.tagName.toLowerCase()&&!r||"Shift"===e.key&&(e.preventDefault(),n())};return window.addEventListener("keydown",e),window.addEventListener("keyup",o),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keydown",o)}}),l)}},65422:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var o=n(97458),l=n(96734),r=n(26766),i=n(62295),s=n(38397),a=n(49183),c=n.n(a),d=n(56010),u=n.n(d),f=n(52983),p=n(89062),v=n(80794),h=n(88223),w=n(48173),m=n(7940),g=n(28640),C=n(59862),E=n(53304),j=n(73908),S=n(54742),k=n(72526),b=n(98507),y=n(14484),I=n(35240),x=n(21311),L=n(64747),A=n(208),_=n(11780),D=n(83157),F=n(95924),P=n(677);const R=c()((async()=>Promise.all([n.e(1035),n.e(6534),n.e(177)]).then(n.bind(n,12971))),{loadableGenerated:{webpack:()=>[12971]},ssr:!1}),O=c()((async()=>Promise.all([n.e(1127),n.e(7443),n.e(7470),n.e(5889)]).then(n.bind(n,20861))),{loadableGenerated:{webpack:()=>[20861]},ssr:!1}),N=c()((async()=>n.e(4813).then(n.bind(n,84813))),{loadableGenerated:{webpack:()=>[84813]},ssr:!1});function T(){var e,t,n,a,c,d,T,M,W,U,V,G,B;const q=(0,s.useRouter)(),{user:J}=(0,m.a)(),{from:Q,id:Y,sort:Z,status:H,type:K}=q.query,X=(0,w.p)(),z=(0,p.useSetRecoilState)(I.qx),[$,ee]=(0,f.useState)(!1),te=(0,p.useSetRecoilState)(x.QJ),[ne,oe]=(0,f.useState)([]),le=(0,p.useSetRecoilState)(b.Y),re=ne.length>0,ie=(0,l.SS)(i.AD.FILE_UPLOAD_LIMIT),[se,ae]=(0,f.useState)(null),[ce,de]=(0,f.useState)(!1),[ue,fe]=(0,f.useState)(null),[pe,ve]=(0,f.useState)(null),[he,we]=(0,f.useState)(!1),{downloadAllInFolder:me,downloadAllInProject:ge,downloadSelection:Ce,isZipDownloadInProgress:Ee}=(0,P.p)();(0,E.Z)({onPress:()=>{de(!0)},onRelease:()=>{de(!1)}});const je=(0,v.m8)(),[Se]=(0,v.aM)({query:k.FE,variables:{id:Y},pause:!Y}),[ke]=(0,v.aM)({query:k.f3,variables:{id:Y,orderBy:Z||JSON.stringify({isFolder:"DESC",updatedAt:"DESC"}),status:H,type:K,first:24},pause:!Y}),be=(null===(e=Se.data)||void 0===e?void 0:e.project)||null,ye=(0,S.hp)(null===(n=Se.data)||void 0===n||null===(t=n.project)||void 0===t?void 0:t.workspaceId),Ie=(0,f.useMemo)((()=>(0,D.fK)(ye)),[ye]),xe=ie.on&&Ie===L.Q.FREE,Le=null===(c=ke.data)||void 0===c||null===(a=c.projectFiles)||void 0===a?void 0:a.edges.map((e=>e.node));(0,f.useEffect)((()=>{Se.fetching||(Se.error?(0,_.w)(Se.error):Se.data&&Se.data.project&&(Se.data.project.isSystem||te({name:Se.data.project.title,isPrivate:Boolean(Se.data.project.isPrivate),projectTitle:Se.data.project.title,type:"project",workspaceId:Se.data.project.workspaceId,projectId:Se.data.project.id}),(0,r.Z9)(new r.RG({projectId:Se.data.project.id,projectName:Se.data.project.title,workspaceId:Se.data.project.workspaceId,url:window.location.href})),z(!1)))}),[Se,q,z,te]);const Ae=(null===(d=ke.data)||void 0===d?void 0:d.projectFiles.pageInfo.endCursor)||null,_e=(null===(T=ke.data)||void 0===T?void 0:T.projectFiles.pageInfo.hasNextPage)||!1,De=(0,f.useCallback)((e=>{fe(F.RT.LOADED);const t=ne,n=t.map((e=>e.id)).indexOf(e);if(Le){const o=Le.find((t=>t.id===e));if(!o)return;const l=Le.indexOf(o);if(ce)if(null===se)t.push(o);else{const e=(0,F.Jm)(se,l,Le);n>-1?(0,F.wh)(t,e):(0,F.AW)(t,e)}else n>-1?t.splice(n,1):t.push(o);ae(l)}0===t.length&&fe(null),oe([...t]),le(t.length)}),[ne,Le,le,se,ce]),Fe=(0,f.useCallback)((()=>{fe(null),le(0),oe([]),ae(null),we(!1)}),[le]);(0,f.useEffect)((()=>{Ee&&Fe()}),[Ee,Fe]);const Pe=(0,f.useCallback)((()=>{if(be)try{var e;Ce({project:be,downloadAssetCount:ue===F.RT.EVERYTHING?(null===(e=ke.data)||void 0===e?void 0:e.projectFiles.totalCount)||0:ne.length,entries:ue===F.RT.EVERYTHING?[{id:Y,type:"PROJECT"}]:ne.map((e=>({id:e.id,type:(0,A.qR)(e)?"FOLDER":"FILE"})))})}catch(e){null==X||X.pushError(e.message)}}),[Ce,be,null===(M=ke.data)||void 0===M?void 0:M.projectFiles.totalCount,ne,ue,X,Y]),Re=(0,f.useCallback)((()=>{if(be)try{var e;ge({project:be,downloadAssetCount:(null===(e=ke.data)||void 0===e?void 0:e.projectFiles.totalCount)||0})}catch(e){null==X||X.pushError(e.message)}}),[ge,be,null===(W=ke.data)||void 0===W?void 0:W.projectFiles.totalCount,X]),Oe=(0,f.useCallback)(((e,t)=>{if(be)try{me({downloadAssetCount:1,folderId:e,folderName:t,project:be})}catch(e){null==X||X.pushError(e.message)}}),[me,be,X]),[Ne,Te]=(0,g._)("project-view","grid"),Me=(0,f.useCallback)((()=>{Te("grid"===Ne?"list":"grid"),(0,r.Z9)(new r.rR({projectId:Y,userId:null==J?void 0:J.id,view:"grid"===Ne?"list":"grid"}))}),[Ne,Te,Y,J]),We=(0,p.useRecoilValue)(y.h),Ue=(0,f.useCallback)((()=>{Fe(),null==X||X.pushSuccess("".concat(ne.length>1?"Assets were":"Asset was"," successfully transferred to ").concat(null==We?void 0:We.name,"."))}),[Fe,ne.length,null==We?void 0:We.name,X]),Ve=(0,f.useCallback)((e=>{var t,n;const o=ne,l=null===(n=ke.data)||void 0===n||null===(t=n.projectFiles)||void 0===t?void 0:t.edges.map((e=>e.node));e?((0,F.AW)(o,l||[]),le(o.length),fe(F.RT.LOADED),we(!0)):((0,F.wh)(o,l||[]),le(o.length),fe(null),we(!1)),oe([...o])}),[null===(V=ke.data)||void 0===V||null===(U=V.projectFiles)||void 0===U?void 0:U.edges,ne,le]),Ge=(0,f.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;if(!Le||0===(null==Le?void 0:Le.length))return;const n=e&&ke.data?(null===(t=ke.data)||void 0===t?void 0:t.projectFiles.totalCount)-(null==Le?void 0:Le.length):24,o=xe?Math.min(12,Math.abs(ie.value-(null==Le?void 0:Le.length))):n;try{ee(!0),await je.query(k.f3,{id:Y,status:H,type:K,orderBy:Z||JSON.stringify({isFolder:"DESC",updatedAt:"DESC"}),after:Ae,first:o}).toPromise()}finally{ee(!1)}}),[Le,ke.data,xe,ie.value,je,Y,H,K,Z,Ae]),Be=(0,f.useCallback)((()=>{Se.data&&!Se.fetching&&!$&&_e&&Ae&&Ge()}),[Ae,Ge,Se.data,Se.fetching,_e,$]);(0,f.useEffect)((()=>{Fe()}),[q.asPath,Fe]);const qe="https://creator.lottiefiles.com",Je=(0,f.useCallback)(((e,t)=>{let n;const o="shared-with-me"===Q;if(((0,A.QR)(e)||(0,A.xK)(e))&&(n=e.fileObject.filename.split(".").pop()),"creator"===n)window.open("".concat(qe,"?fileId=").concat(e.id,"&utm_medium=platform&utm_source=file-card"),"_blank");else{let n;n=(0,A.qR)(e)?"/folder/".concat(e.id):"/animation/".concat(e.id),Z&&(n+="?sort=".concat(encodeURIComponent(Z.toString()))),o&&(n+="".concat(Z?"&":"?","from=shared-with-me")),t?window.open(n,"_blank"):q.push(n)}}),[Q,qe,Z,q]),Qe=(0,f.useCallback)((async()=>{if(Le){const e=await je.query(k.A0,{id:Y}).toPromise();e.data&&ve(e.data.project.stats),oe([...Le])}fe(F.RT.EVERYTHING)}),[je,Y,Le]),Ye=ne.length&&(null==Le?void 0:Le.some((e=>-1===ne.findIndex((t=>t.id===e.id)))))||!1,{hasDownloadAccess:Ze,hasUpdateAccess:He}=(0,C.O)({scopes:(null==be?void 0:be.projectPermissionScopes)||[]}),Ke=(0,f.useMemo)((()=>"folders"!==K&&(null==be?void 0:be.isSystem)&&"Drafts"===(null==be?void 0:be.title)),[be,K]),[Xe,ze]=(0,f.useState)(!1);return(0,f.useEffect)((()=>{Ke&&(null==J?void 0:J.id)&&!Xe&&((0,r.Z9)(new r.di({userId:J.id})),ze(!0))}),[Ke,null==J?void 0:J.id,Xe]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u(),{children:(0,o.jsx)("title",{children:"LottieFiles Platform"})}),(0,o.jsx)(j.s,{features:null==be?void 0:be.features,children:(0,o.jsx)(h.o,{headerWrapperCssClasses:"flex items-center px-6 flex-shrink-0 pt-6 pb-4",contentWrapperCssClasses:"flex-grow p-6 pt-0",headerControl:(0,o.jsx)(R,{selectedCount:ne.length,loadedCount:(null==Le?void 0:Le.length)||0,showFilters:0!==(null==Le?void 0:Le.length)||(Boolean(H)||Boolean(K)),totalCount:(null===(G=ke.data)||void 0===G?void 0:G.projectFiles.totalCount)||0,onSelectAll:Ve,selectionIsIndeterminate:Ye,isSelectionMode:re,toggleProjectView:Me,projectView:Ne,project:be,fromSharedWithMe:"shared-with-me"===Q,selectionType:ue,onSelectEverything:Qe,clearSelection:Fe,showSelectionBanner:he,onDownloadAllClick:Re,showSelectAll:Ze()||He()}),children:(0,o.jsx)("div",{className:"h-full space-y-3",children:be&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(N,{files:Le,hasNextPage:_e,isCreatorDraft:Ke,isFetchingFiles:ke.fetching,isFetchingMore:$,isSelectionMode:re,onFolderDownloadAllClick:Oe,onItemClick:Je,onLoadMore:Be,onSelectionChange:De,project:be,selectedFiles:ne,status:H,type:K,view:Ne}),re?(0,o.jsx)(O,{canDelete:He(),canDownload:Ze(),canMove:He(),canUpdateStatus:He(),canAddToCollection:He(),type:"project",resourceId:be.id,workspaceId:be.workspace.id,selectedAnimations:ne,isPrivate:be.isPrivate,clear:Fe,onDownload:Pe,onTransferComplete:Ue,totalCount:(null===(B=ke.data)||void 0===B?void 0:B.projectFiles.totalCount)||0,contentStats:pe,isEverythingSelected:ue===F.RT.EVERYTHING}):null]})})})})]})}},73908:function(e,t,n){"use strict";n.d(t,{s:function(){return s},w:function(){return a}});var o=n(97458),l=n(62295),r=n(52983);const i=r.createContext({features:[]}),s=e=>{let{children:t,features:n}=e;return(0,o.jsx)(i.Provider,{value:{features:n},children:t})},a=()=>{const{features:e}=r.useContext(i);return e?new l.UZ(e):new l.UZ([])}},98507:function(e,t,n){"use strict";n.d(t,{Y:function(){return o}});const o=(0,n(89062).atom)({key:"selectedAnimationsCount",default:0})},8855:function(e,t,n){"use strict";n.d(t,{h:function(){return l}});var o=n(89062);const l=(0,o.atom)({key:"transferSelectionAtom",default:null});(0,o.atom)({key:"createNewFolder",default:!1})},14484:function(e,t,n){"use strict";n.d(t,{h:function(){return o.h}});var o=n(8855)},208:function(e,t,n){"use strict";var o,l,r,i,s,a,c;n.d(t,{GN:function(){return o},QR:function(){return u},eL:function(){return i},hF:function(){return r},nT:function(){return a},qR:function(){return p},ws:function(){return c},xK:function(){return f},yx:function(){return v}}),function(e){e.DOWNLOAD="download",e.FULL_ACCESS="full_access",e.PUBLIC_DOWNLOAD="public_download",e.PUBLIC_VIEW="public_view",e.VIEW="view"}(o||(o={})),function(e){e.Loop="Loop",e.PlayOnce="PlayOnce"}(l||(l={})),function(e){e.DotLottie="lottie",e.Gif="gif",e.LottieJson="json",e.Mp4="mp4"}(r||(r={})),function(e){e.GIF="gif",e.MOV="mov",e.MP4="mp4",e.WEBM="webm"}(i||(i={})),function(e){e.DOWNLOAD="download",e.FULL_ACCESS="full_access",e.PUBLIC_DOWNLOAD="public_download",e.PUBLIC_VIEW="public_view",e.VIEW="view"}(s||(s={})),function(e){e.Approved="Approved",e.InProgress="InProgress",e.NeedsReview="NeedsReview",e.Shipped="Shipped"}(a||(a={})),function(e){e.Completed="Completed",e.Failed="Failed",e.InProgress="InProgress",e.Pending="Pending"}(c||(c={}));const d=e=>e.split(".").pop();function u(e){if(!e.fileObject)return!1;const t=e.fileObject.filename,n=d(t);return void 0!==n&&["lottie","json"].includes(n)}function f(e){if(!e.fileObject)return!1;const t=e.fileObject.filename,n=d(t);return void 0!==n&&"creator"===n}function p(e){return e&&"Folder"===e.__typename}var v;!function(e){e.COLOR_PALETTE="color-palette",e.DIRECT="Direct",e.PLAY_SEGMENTS="play-segments",e.PREMIUM_ANIMTIONS="premium-animations",e.URL="URL"}(v||(v={}))},9233:function(e,t,n){"use strict";var o;function l(e){return"object"==typeof e&&null!==e&&"folders"in e}n.d(t,{k:function(){return l},l:function(){return o}}),function(e){e.DOWNLOAD="download",e.FULL_ACCESS="full_access",e.VIEW="view"}(o||(o={}))},11780:function(e,t,n){"use strict";n.d(t,{w:function(){return i}});var o=n(25921),l=n(45233);const r={"Access denied!":e=>{var t,n,l,r;const i=null!==(r=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==r?r:"";var s;const a=null!==(s=null==e||null===(l=e.extensions)||void 0===l||null===(n=l.exception)||void 0===n?void 0:n.stacktrace)&&void 0!==s?s:[];throw console.log("Error code:",i),console.log("Stacktrace:",a),new o.J},"Database query failed":e=>{var t,n,l,r;const i=null!==(r=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==r?r:"";var s;const a=null!==(s=null==e||null===(l=e.extensions)||void 0===l||null===(n=l.exception)||void 0===n?void 0:n.stacktrace)&&void 0!==s?s:[];throw console.log("Error code:",i),console.log("Stacktrace:",a),new o.J},"File not found":e=>{var t,n,o,r;const i=null!==(r=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==r?r:"";var s;const a=null!==(s=null==e||null===(o=e.extensions)||void 0===o||null===(n=o.exception)||void 0===n?void 0:n.stacktrace)&&void 0!==s?s:[];throw console.log("Error code:",i),console.log("Stacktrace:",a),new l.T},Forbidden:e=>{var t,n,l,r;const i=null!==(r=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==r?r:"";var s;const a=null!==(s=null==e||null===(l=e.extensions)||void 0===l||null===(n=l.exception)||void 0===n?void 0:n.stacktrace)&&void 0!==s?s:[];throw console.log("Error code:",i),console.log("Stacktrace:",a),new o.J}};function i(e){e.networkError?console.error("Network error:",e.networkError):e.graphQLErrors&&e.graphQLErrors.length>0?e.graphQLErrors.forEach((e=>{const t=e.message,n=Object.keys(r).find((e=>t.includes(e)));var o;n?null===(o=r[n])||void 0===o||o.call(r,e):console.error("GraphQL error:",e)})):console.error("Unknown error:",e)}},95924:function(e,t,n){"use strict";var o;function l(e,t,n){const o=Math.min(e,t),l=Math.max(e+1,t+1);return n.splice(o,l-o)}function r(e,t){t.forEach((t=>{const n=e.findIndex((e=>e.id===t.id));n>-1&&e.splice(n,1)}))}function i(e,t){t.forEach((t=>{-1===e.findIndex((e=>e.id===t.id))&&e.push(t)}))}n.d(t,{AW:function(){return i},Jm:function(){return l},RT:function(){return o},wh:function(){return r}}),function(e){e.EVERYTHING="everything",e.LOADED="loaded"}(o||(o={}))}},function(e){e.O(0,[2888,9774,179],(function(){return t=1704,e(e.s=t);var t}));var t=e.O();_N_E=t}]);